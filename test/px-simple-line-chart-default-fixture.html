<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="shortcut icon" href="../favicon.ico" />
        <title>px-simple-line-chart Demo</title>
        <!-- Requires Webcomponents.js polyfill is provided by the page for browsers that don't support html imports -->
        <script src="../bower_components/webcomponentsjs/webcomponents-lite.min.js"></script>
        <script src="../web-component-tester/browser.js"></script>
        <script src="../demo-data/sample-data.js"></script>
        <!-- Import custom element. Note: see comment about relative paths to dependencies in the *.html file referenced below -->
        <link rel="import" href="../px-simple-line-chart.html" />
    </head>
    <body>

        <px-simple-line-chart id="fixture"></px-simple-line-chart>

        <script>

            var fixture, div, svg;

            function waitFor(done, fn) {
              var myInterval, myTimeout;

              myTimeout = setTimeout(function() {
                clearInterval(myInterval); // worst case, kill interval after 1/2 a second
                clearTimeout(myTimeout);
                done();
              }, 3001);

              // loop until calendar cells have rendered
              myInterval = setInterval(function() {
                if (fn()) { // if the function returns true, call done()
                  clearInterval(myInterval);
                  clearTimeout(myTimeout);
                  done();
                }
              }, 50);
            };

            describe('default <px-simple-line-chart> basic features', function() {


                before(function(done) {

                    var svgIsReady = function() {
                        fixture = document.getElementById('fixture');
                        console.log('fixture: ', fixture);
                        if(fixture) {
                            div = fixture.querySelector('div');
                            if(div) {
                                console.log('div: ', div);
                                svg = div.children[0];
                                if(svg.tagName.toLowerCase() === 'svg') {
                                    console.log('svg: ', svg);
                                    return true;
                                } else {
                                    return false;
                                };
                            } else {
                                return false;
                            };
                        } else {
                            return false;
                        };
                    };
                    var chartIsDrawn = function() {
                        waitFor(done, function(){
                            console.log('svg offsetHeight: ', svg.offsetHeight);
                            if(svg.offsetHeight > 0) {
                                return true;
                            } else {
                                return false;
                            }

                        });
                    };
                    waitFor(chartIsDrawn, svgIsReady)
                });

                it('fixture exists', function(done) {
                    assert.isTrue(fixture !== null);
                    done();
                });
                it('SVG element exists', function(done) {
                    assert.isTrue(svg.tagName.toLowerCase() === 'svg');
                    done();
                });
                it('SVG element has height greater than zero', function(done) {
                    console.log('svg: ', svg.attributes);
                    console.log('svg: ', svg.width, svg.height);
                    assert.isTrue(svg.offsetHeight > 0);
                    done();
                });
                it('SVG element has default height', function(done) {
                    assert.isTrue(svg.offsetHeight === 150);
                    done();
                });
                it('SVG element has width greater than zero', function(done) {
                    assert.isTrue(svg.offsetHeight > 0);
                    done();
                });
                it('SVG element has default width', function(done) {
                    var width = svg.offsetHeight;
                    assert.isTrue(Number(width) === 283);
                    done();
                });
            });
        </script>

    </body>
</html>
